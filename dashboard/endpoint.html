<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Admin Dashboard</title>

    <!-- font awesome link-->
    <script src="https://kit.fontawesome.com/c4b75b0548.js" crossorigin="anonymous"></script>
    <!-- data tables css -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css">
    <!-- select2 styling -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" integrity="sha512-nMNlpuaDPrqlEls3IX/Q56H36qvBASwb3ipuo3MxeWbsQB1881ox0cRv7UPTgBlriqoynt35KjEwgGUeUXIPnw==" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

    <!-- Custom styles for dashboard-->
    <link href="css/admin.css" rel="stylesheet">

    <!-- toastr css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.css" integrity="sha512-3pIirOrwegjM6erE5gPSwkUzO+3cTjpnV9lexlNZqvupR64iZBnOOTiiLPb9M36zpMScbmUNIcHUqKD47M719g==" crossorigin="anonymous" />

</head>
<style>
    .games {
        word-wrap: break-word;
    }
</style>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">
                    <div class="text-center">
<<<<<<< HEAD
                        <a class="pl-3 pr-3" href="partner.html">Tables</a>
                        <a class="pl-3 pr-3" href="./userdashboard.html">User Dashboard</a>
=======
                        <a class="pl-3 pr-3" href="tables.html">Tables</a>
                        <a class="pl-3 pr-3" href="./user1.html">User Dashboard</a>
>>>>>>> d08bbaf1504791df33224d416a72232ed5e4d640
                        <a class="pl-3 pr-3" href="./endpoint.html">Check Endpoints</a>
                    </div>



                    <!-- Topbar Navbar -->
                    <ul class="navbar-nav ml-auto">

                        <div class="topbar-divider d-none d-sm-block"></div>

                        <!-- Nav Item - User Information -->
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="mr-2 d-none d-lg-inline text-gray-600 small"> Admin</span>
                                <i class="fas fa-angle-down"></i>
                            </a>
                            <!-- Dropdown - User Information -->
                            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in" aria-labelledby="userDropdown">
                                <!-- <div class="dropdown-divider"></div> -->
                                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i> Logout
                                </a>
                            </div>
                        </li>

                    </ul>

                </nav>
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid">
                    <a class="btn btn-primary float-right mb-3" href="#" data-toggle="modal" data-target="#Editpartnerinfo4">
                        Click to Select an action <i class="fas fa-plus"></i>
                    </a>
                </div>
            </div>
            <!-- /.container-fluid -->

        </div>
        <!-- End of Main Content -->
    </div>
    <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->
    <!-- DataTales Example -->
    <div class="card shadow mb-4">
        <div class="card-header py-3">
            <h3 class="m-0 font-weight-bold text-primary text-center">Check Partners Endpoints</h3>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                    <thead>
                        <tr>
                            <th>Partner ID</th>
                            <th>Business Name</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- tbody is being loaded from db -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Logout Modal-->
    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">Ã—</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                    <a class="btn btn-primary" href="login.html">Logout</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit partner information -->
    <div class="modal fade" id="Editpartnerinfo" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="myModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title create-modal-title">Select an endpoint to continue</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="pb-3">
                        <button class="btn btn-outline-success" onclick="viewCatalog()">View Catalog</button>
                    </div>
                    <div class="pb-3">
                        <button class="btn btn-outline-success" onclick="filterCatalog()">Filter Catalog </button>
                    </div>
                    <div class="pb-3">
                        <button class="btn btn-outline-success" onclick="viewList()">View List of Variables</button>
                    </div>
                    <div class="pt-3 float-right">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="modal fade" id="Editpartnerinfo2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="myModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title2 create-modal-title"></h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <a target="blank" id="endpoint-link"></a>
                    <div class="pt-5 float-right">
                        <button type="button" onclick="cancelBtn()" id="cancelBtn" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="Editpartnerinfo3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="myModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title3 create-modal-title">Choose a Category to Generate url</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div>
                        <input type="radio" id="Subject" name="filter" value="Subject">
                        <label for="Subject">Subject</label><br>
                        <input type="radio" id="female" name="filter" value="Level">
                        <label for="female">Level</label><br>
                        <input type="radio" id="Group" name="filter" value="Group">
                        <label for="Group">Group</label><br>
                        <input type="radio" id="Subject & Group" name="filter" value="Subject & Group">
                        <label for="Subject & Group">Subject & Group</label><br>
                        <input type="radio" id="Subject & Level" name="filter" value="Subject & Level">
                        <label for="Subject & Level">Subject & Level</label><br>
                        <input type="radio" id="Group & Level" name="filter" value="Group & Level">
                        <label for="Group & Level">Group & Level</label><br>
                        <input type="radio" id="other" name="filter" value="Subject & Group & Level">
                        <label for="Subject & Group & Level">Subject & Group & Level</label>
                    </div>
                    <div class="pt-2 float-right">
                        <button type="button" onclick="cancelBtn()" id="cancelBtn" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                        <button onclick="filterAllCatalog()" id="generateLink" class="btn btn-primary">Generate</button>
                        <!-- <button type="submit" id="edit-partner" class="btn btn-primary" onclick="updatePartnerinfo()">Update</button> -->
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="modal fade" id="Editpartnerinfo4" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="myModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title4 create-modal-title">Select an action</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="pb-3">
                        <button class="btn btn-outline-success" onclick="subscribeUser()">Subscribe a User</button>
                    </div>
                    <div class="pb-3">
                        <button class="btn btn-outline-success" onclick="unsubscribeUser()">Unsubscribe a User</button>
                    </div>
                    <div class="pb-3">
                        <button class="btn btn-outline-success" onclick="playGame()">Play a game</button>
                    </div>
                    <div class="pt-5 float-right">
                        <button type="button" id="cancelBtn" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="Editpartnerinfo5" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="myModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title5 create-modal-title">Enter User Details to Generate Link</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="">
                            <label>Enter PartnerID</label><span class="text-danger"> *</span>
                            <input type="number" id="partnerid" class="form-control" placeholder="Enter PartnerID" required>
                            <span class="partnerError d-none">PartnerID cannot be less than 6 characters</span>
                        </div>
                        <div class="pt-3">
                            <label>Enter Access token</label><span class="text-danger"> *</span>
                            <input type="text" id="accesstkn" class="form-control" placeholder="Enter partner access token" required>
                            <span class="accessError d-none">Access token cannot be less than 28 characters</span>
                        </div>
                        <div class="pt-3">
                            <label>Enter UserPassport</label><span class="text-danger"> *</span>
                            <input type="text" name="userpassport" id="userpassport" class="form-control" placeholder="Enter email address or phone number" required>
                            <p class="userpassport-error text-danger d-none">please enter email or phone number</p>
                        </div>
                        <div class="pt-3 expirydiv">
                            <label>Enter Expiry Date (Optional)</label>
                            <input type="text" id="expiry-date" class="form-control expires" placeholder="DD-MM-YYYY" required>
                        </div>
                        <div class="pt-5 float-right">
                            <button type="button" onclick="cancelBtn2()" id="cancelBtn" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                            <button type="button" onclick="generateUrlLink()" id="generate" class="btn btn-primary generate">Generate</button>
                            <button type="button" onclick="generateUrLink2()" id="generate2" class="btn btn-primary d-none generatebtn2">Generate</button>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    </div>
    <div class="modal fade" id="Editpartnerinfo6" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="myModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title6 create-modal-title">Click link below to test endpoint</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <a target="blank" id="endpoint-link2"></a>
                    <div class="pt-5 float-right">
                        <button type="button" onclick="cancelBtn2()" id="cancelBtn" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="modal fade" id="Editpartnerinfo7" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="myModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title5 create-modal-title">Enter User Details to Generate Link</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div>
                        <label>Enter UserPassport</label><span class="text-danger"> *</span>
                        <input type="text" id="userpassport2" class="form-control" placeholder="Enter email address or phone number">
                        <p class="text-danger error-class d-none">Please enter a valid email or phone number</p>
                    </div>

                    <div class="pt-3">
                        <label>Enter GameID</label><span class="text-danger"> *</span>
                        <input type="number" id="gameid" class="form-control" placeholder="Enter GameID eg 13">
                        <p class="text-danger error-class2 d-none">Please enter an id</p>
                    </div>
                    <div class="pt-5 float-right">
                        <button type="button" onclick="cancelBtn2()" id="cancelBtn" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                        <button type="button" onclick="generateGameID()" id="generate" class="btn btn-primary">Generate</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="modal fade" id="Editpartnerinfo8" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="myModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title8 create-modal-title">Select an action</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="pb-3">
                        <button class="btn btn-outline-success" onclick="subject()">Subject</button>
                    </div>
                    <div class="pb-3">
                        <button class="btn btn-outline-success" onclick="group()">Group</button>
                    </div>
                    <div class="pb-3">
                        <button class="btn btn-outline-success" onclick="level()">Level</button>
                    </div>
                    <div class="pt-5 float-right">
                        <button type="button" id="cancelBtn" class="btn btn-danger"  onclick="cancelBtn()">Cancel</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="modal fade" id="Editpartnerinfo9" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" id="myModal">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title9 create-modal-title">Select one or more Categories to continue</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div>
                        <label for="">Select any Group</label><br>
                        <select id="group" class="form-control">
                        </select>
                    </div>
                    <div class="pt-3">
                        <label for="">Select any level</label><br>
                        <select id="level" class="form-control">
                        </select>
                    </div>
                    <div class="pt-3">
                        <label>Select any Subject</label><br>
                        <select id="subject" class="form-control">
                        </select>
                    </div>
                    <div class="text-wrap pt-3">
                        <p class="test"></p>
                        <a target="blank" class="games text-wrap"></a>
                    </div>

                    <div class="pt-2 float-right">
                        <button type="button" onclick="cancelBtn()" id="cancelBtn" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                        <button type="button" id="generatemultilinks" class="btn btn-primary generate">Generate</button>
                    </div>
                    <p class="link"></p>
                </div>
            </div>

        </div>
    </div>

    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- toastr js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js" integrity="sha512-VEd+nq25CkR676O+pLBnDW09R7VQX9Mdiij052gVCp5yVH3jGtH70Ho/UUv4mJDsEdTvqRCFZg0NKGiojGnUCw==" crossorigin="anonymous"></script>
    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <!-- data tables Javascript -->
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <!-- Select2 Javascript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js" integrity="sha512-2ImtlRlf2VVmiGZsjm9bEyhjGW4dU7B6TNwh/hx/iSByxNENtj3WVE6o/9Lj4TJeVXPi4bnOIMXFIJJAeufa0A==" crossorigin="anonymous"></script>

    <script>
        $(document).ready(function() {
            getAllPartners();
            getGroups();
            getLevels();
            getSubjects();
            $('#games').select2({
                dropdownParent: $('#myModal')
            });
        })

        //function to fetch all partners from db
        async function getAllPartners() {
            try {
                const response = await fetch('api.php/GetPartnerSubscription', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                let result = data.data;
                let databody = "";
                // load table row into table
                for (const partner of result) {
                    const partnerInfo = `<tr>
                    <td>${partner.PartnerID}</td>
                    <td>${partner.BusinessName}</td>
                    <td><button class="btn btn-primary btn-edit" data-toggle="modal" data-target="#Editpartnerinfo" onclick="Select('${partner.PartnerID}', '${partner.PartnerAccessToken}', '${partner.UserPassport}', '${partner.ExpiryDate}')">Select</button></td>
                    </tr>`
                    databody += partnerInfo;
                }
                $('#dataTable > tbody').append(databody);
                $('#dataTable').DataTable();
                return result;
            } catch (error) {
                console.log(error);
            }
        }
        async function getGroups() {
            try {
                const response = await fetch('api.php/GetGroup', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                let groups = data.data;
                let gameGroups = groups.map((group) => {
                    const groupOptions = `<option value="${group.groupName}">${group.groupName}</option>`
                    return groupOptions
                }).join()
                $('#group').append(gameGroups)
            } catch (error) {
                console.log(error);
            }
        }
        async function getLevels() {
            try {
                const response = await fetch('api.php/GetLevel', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                let groups = data.data;
                let gameGroups = groups.map((group) => {
                    const groupOptions = `<option value="${group.levelName}">${group.levelName}</option>`
                    return groupOptions
                }).join()

                $('#level').append(gameGroups)
            } catch (error) {
                console.log(error);
            }
        }
        async function getSubjects() {
            try {
                const response = await fetch('api.php/GetSubject', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                let groups = data.data;
                let gameGroups = groups.map((group) => {
                    const groupOptions = `<option value="${group.subjectName}">${group.subjectName}</option>`
                    return groupOptions
                }).join()
                $('#subject').append(gameGroups)

            } catch (error) {
                console.log(error);
            }
        }

        function Select(pid, ptoken, usp, ed) {
            let partnerID = pid,
                token = ptoken,
                userpass = usp,
                expDate = ed,
                partnerArr = [partnerID, token, usp, ed],
                array = sessionStorage.setItem('partnerinfo', JSON.stringify(partnerArr));
        }

        function link() {
            $(".modal-title2").append("Click link below to test endpoint");
            $("#Editpartnerinfo2").modal();
        }

        let url = `https://partners.9ijakids.com/index.php?partnerId=`,
            urlbody = `&accessToken=`;

        //generate url for viewing partner's catalog
        function viewCatalog() {
            let storedItem = JSON.parse(sessionStorage.getItem('partnerinfo')),
                partnerid = storedItem[0],
                accessToken = storedItem[1],
                urlEnd = `&action=catalog`,
                fullUrl = url.concat(partnerid, urlbody, accessToken, urlEnd);
            console.log(fullUrl);
            $("#Editpartnerinfo2").modal();
            $("#Editpartnerinfo").modal().hide();
            $("#endpoint-link").attr("href", fullUrl)
            $('#endpoint-link').append(fullUrl);
            link();
        }
        //function to cancel first modal involving view catalog, filter catalog, view list of subjects
        function cancelBtn() {
            $("#endpoint-link").attr("href", '')
            $('#endpoint-link').empty().append();
            $(".modal-title2").empty().append();
            $("#Editpartnerinfo").modal().show();
        }
        //function to cancel first modal involving subscribe, unsubscribe, and play game
        function cancelBtn2() {
            $("#endpoint-link2").attr("href", '')
            $('#endpoint-link2').empty().append();
            $(".modal-title2").empty().append();
            $("#Editpartnerinfo4").modal().show();
        }
        //function to hide select end point to continue
        function filterCatalog() {
            $("#Editpartnerinfo9").modal().show();
            $("#Editpartnerinfo").modal().hide();
            
        }
        //to check expiry
        function checkExpiry() {
            if ($('#partnerid').length < 6) {
                $('.partnerError').addClass('d-none')
            }
        }

        function generateLinks(group = '', level = '', subject = '') {
            $(".games").removeAttr("href");
            let storedItem = JSON.parse(sessionStorage.getItem('partnerinfo')),
                partnerid = storedItem[0],
                accessToken = storedItem[1];
            let gameVal = document.querySelector('.games');
            let parameter = `?partnerId=${partnerid}&accessToken=${accessToken}&action=catalogfilter`;
            let url = 'https://partners.9ijakids.com/index.php';


            let groupUrl = group != '' ? `&Group=${group.split(' ').join('%20')}` : ''
            let levelUrl = level != '' ? `&Level=${level.split(' ').join('%20')}` : ''
            let subjectUrl = subject != '' ? `&Subject=${subject.split(' ').join('%20')}` : '';
            gameVal.innerHTML = ''
            gameVal.innerHTML = `${url}${parameter}${groupUrl}${levelUrl}${subjectUrl}`;
            let fulLink = `${url}${parameter}${groupUrl}${levelUrl}${subjectUrl}`;

            $(".games").attr("href", fulLink);
        }
        const buttonGenerate = document.getElementById("generatemultilinks"),
            groupVal = document.getElementById("group"),
            levelVal = document.getElementById("level"),
            subjectVal = document.getElementById("subject");
        buttonGenerate.addEventListener('click', () => {
            generateLinks(groupVal.value, levelVal.value, subjectVal.value)
        })

        function checkAccessToken() {
            if ($('#partnerid').length < 28) {
                $('.accessError').addClass('d-none')
            }
        }
        //function to view list of all subjects
        function viewList() {
            $("#Editpartnerinfo").modal().hide();
            $("#Editpartnerinfo8").modal().show();
        }

        function subject() {
            let storedItem = JSON.parse(sessionStorage.getItem('partnerinfo')),
                partnerid = storedItem[0],
                accessToken = storedItem[1],
                urlEnd = `&action=subject`,
                fullUrl = url.concat(partnerid, urlbody, accessToken, urlEnd);
            $("#endpoint-link").attr("href", fullUrl)
            $('#endpoint-link').append(fullUrl);
            $("#Editpartnerinfo8").modal().hide();
            link()
        }
        function group(){
            let storedItem = JSON.parse(sessionStorage.getItem('partnerinfo')),
                partnerid = storedItem[0],
                accessToken = storedItem[1],
                urlEnd = `&action=group`,
                fullUrl = url.concat(partnerid, urlbody, accessToken, urlEnd);
            $("#endpoint-link").attr("href", fullUrl)
            $('#endpoint-link').append(fullUrl);
            $("#Editpartnerinfo8").modal().hide();
            link()
        }
        function level(){
            let storedItem = JSON.parse(sessionStorage.getItem('partnerinfo')),
                partnerid = storedItem[0],
                accessToken = storedItem[1],
                urlEnd = `&action=level`,
                fullUrl = url.concat(partnerid, urlbody, accessToken, urlEnd);
            $("#endpoint-link").attr("href", fullUrl)
            $('#endpoint-link').append(fullUrl);
            $("#Editpartnerinfo8").modal().hide();
            link()
        }
        //function to check if userpassport field is empty
        function inputCheck() {
            if ($('#userpassport').val() == "") {
                $('.userpassport-error').removeClass("d-none")
            } else {}
        }
        //function to subscribe a new user
        function subscribeUser() {
            $(".generatebtn2").addClass('d-none')
            $(".generate").removeClass('d-none')
            $(".expirydiv").show();
            $("#Editpartnerinfo4").modal().hide();
            $("#Editpartnerinfo5").modal().show();
        }

        // function to get expiry date entered
        function date() {
            var date = new Date($('#expiry-date').val());
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();
            expires = [day, month, year].join('-')
        }
        //function to generate url to subscribe a user 
        function generateUrlLink() {
            checkExpiry();
            checkAccessToken();
            let partnerid = $('#partnerid').val(),
                accessToken = $('#accesstkn').val(),
                UserPassport = $('#userpassport').val(),
                expiryDateEntered = date(),
                urlEnd = ` & action = subscribe `,
                urlpass = ` & userPassport = `,
                urldate = ` & expiryDate = `;
            $("#Editpartnerinfo5").modal().hide();
            if (expiryDateEntered != "") {
                let fullUrl = url.concat(partnerid, urlbody, accessToken, urlpass, UserPassport, urldate, expiryDateEntered, urlEnd);
            } else {
                let fullUrl = url.concat(partnerid, urlbody, accessToken, urlpass, UserPassport, urlEnd);
            }
            console.log(fullUrl);
            $("#Editpartnerinfo6").modal().show();
            $("#endpoint-link2").attr("href", fullUrl);
            $('#endpoint-link2').append(fullUrl);
        }
        //function to generate url to unsubscribe a user 
        function generateUrLink2() {
            $("#Editpartnerinfo5").modal().hide();
            partnerid = $('#partnerid').val(),
                accessToken = $('#accesstkn').val(),
                UserPassport = $('#userpassport').val(),
                urlEnd = ` & action = unsubscribe `,
                urlpass = ` & userPassport = `,
                fullUrl = url.concat(partnerid, urlbody, accessToken, urlpass, UserPassport, urlEnd);
            $("#endpoint-link2").attr("href", fullUrl);
            $('#endpoint-link2').append(fullUrl);
            console.log(fullUrl);
            $("#Editpartnerinfo6").modal().show();
        }
        //function to hide expiry div for unsubscribing a user
        function unsubscribeUser() {
            $(".generatebtn2").removeClass('d-none')
            $(".generate").addClass('d-none')
            $(".expirydiv").hide();
            $("#Editpartnerinfo4").modal().hide();
            $("#Editpartnerinfo5").modal().show();
        }
        //function to hide select an action div
        function playGame() {
            $("#Editpartnerinfo4").modal().hide();
            $("#Editpartnerinfo7").modal().show();
        }
        //function to generate url to play game 
        function generateGameID() {
            if ($('#userpassport2').val() == "" && $('#gameid').val() == "") {
                $('.error-class').removeClass("d-none")
                $('.error-class2').removeClass("d-none")
            } else {
                $("#Editpartnerinfo7").modal().hide();
                let storedItem = JSON.parse(sessionStorage.getItem('partnerinfo')),
                    url = `
                https: //partners.9ijakids.com/index.php/play?partnerId=`,
                    partnerid = storedItem[0],
                    UserPassport = $('#userpassport2').val(),
                    urlpass = `&userPassport=`,
                    accessToken = storedItem[1],
                    urlEnd = `&action=play&`,
                    urlend2 = ` gameID=`,
                    gameId = $('#gameid').val(),
                    fullUrl = url.concat(partnerid, urlbody, accessToken, urlpass, UserPassport, urlEnd, urlend2, gameId);
                $("#endpoint-link2").attr("href", fullUrl);
                $('#endpoint-link2').append(fullUrl);
                console.log(fullUrl);
                $("#Editpartnerinfo6").modal().show();
            }
        }
    </script>
</body>

</html>